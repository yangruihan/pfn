# ============================================================

# AUTO-GENERATED CODE - DO NOT EDIT

# Generated by Pfn compiler

# Generated at: 2026-02-28 21:52:37

# ============================================================



from __future__ import annotations

from stdlib import String, List, Dict, Set, Maybe, Result, Just, Nothing, Ok, Err, Record

from stdlib import reverse, _not_

from bootstrap.Token import *

from bootstrap.AST import *

from dataclasses import dataclass

@dataclass
class ParseError:
    message: str
    token: Token

def parseError(message):
    return lambda token: Record({"message": message, "token": token})

def errorToString(err):
    return err.message + ' at ' + spanToString(err.token.span)

def spanToString(span):
    return 'line ' + toString(span.line) + ', column ' + toString(span.column)

from dataclasses import dataclass

@dataclass
class ParserState:
    tokens: list[Token]
    pos: int

def initParser(tokens):
    return Record({"tokens": tokens, "pos": 0})

precedence = Dict.fromList([(DOUBLE_PIPE, 1), (DOUBLE_AMP, 2), (EQ, 3), (NEQ, 3), (LT, 3), (LE, 3), (GT, 3), (GE, 3), (DOUBLE_COLON, 4), (DOUBLE_PLUS, 5), (PLUS, 6), (MINUS, 6), (STAR, 7), (SLASH, 7), (PERCENT, 7), (FAT_ARROW, 8)])

def getPrecedence(tt):
    return __helper_0(Dict.lookup(tt)(precedence))

def current(state):
    return __helper_2(List.getAt(state.pos)(state.tokens))

def peek(state):
    return __helper_3(List.getAt(state.pos + 1)(state.tokens))

def check(state):
    return lambda types: List.member(current(state).tokenType)(types)

def matchToken(state):
    return lambda types: (Just(current(state)), Record({**state, "pos": state.pos + 1})) if check(state)(types) else (Nothing, state)

def expect(state):
    return lambda tt: lambda message: __helper_5(matchToken(state)([tt])) if check(state)([tt]) else Err(parseError(message)(current(state)))

def advance(state):
    return Record({**state, "pos": state.pos + 1})

def getTokenString(token):
    return __helper_6(token.value)

def getTokenInt(token):
    return __helper_7(token.value)

def getTokenFloat(token):
    return __helper_8(token.value)

def getTokenChar(token):
    return __helper_9(token.value)

def parse(tokens):
    return parseModule(initParser(tokens))

def parseModule(state):
    return parseDeclarations(state)([])

def parseDeclarations(state):
    return lambda decls: Ok(Record({"name": Nothing, "declarations": List.reverse(decls)})) if check(state)([EOF]) else __helper_10(parseDeclaration(state))

def parseDeclaration(state):
    return __helper_26(matchToken(state)([KW_DEF]))

def parseDecorator(state):
    return ((((((__helper_32(matchToken(s3)([LPAREN]))) if (s3 := (advance(s2))) is not None else None) if check(s2)([IDENT]) and getTokenString(current(s2)) == 'export' else Err(parseError("Expected 'export' after '@py.'")(current(s2)))) if (s2 := (advance(s1))) is not None else None) if check(s1)([DOT]) else Err(parseError("Expected '.' after '@py'")(current(s1)))) if (s1 := (advance(state))) is not None else None) if check(state)([IDENT]) and getTokenString(current(state)) == 'py' else Err(parseError("Expected 'py' after '@'")(current(state)))

def parseDef(state):
    return lambda isExported: lambda exportName: __helper_37(expect(state)(IDENT)('Expected function name'))

def parseParams(state):
    return __helper_39(matchToken(state)([LPAREN]))

def parseParamList(state):
    return lambda params: __helper_43(parseParam(state))

def parseParam(state):
    return __helper_47(expect(state)(IDENT)('Expected parameter name'))

def parseReturnType(state):
    return __helper_50(matchToken(state)([ARROW]))

def parseTypeDecl(state):
    return __helper_58(expect(state)(IDENT)('Expected type name'))

def parseTypeParams(state):
    return parseTypeParamsLoop(state)([])

def parseTypeParamsLoop(state):
    return lambda params: ((((parseTypeParamsLoop(advance(state))(params + [name])) if (name := (getTokenString(current(state)))) is not None else None) if List.member(peekTok.tokenType)([EQUALS, PIPE, EOF]) else Ok((params, state))) if (peekTok := (peek(state))) is not None else None) if check(state)([IDENT]) else Ok((params, state))

def parseConstructors(state):
    return lambda ctors: __helper_62(matchToken(state)([PIPE]))

def parseConstructorFields(state):
    return lambda fields: __helper_63(parseTypeAtom(state)) if check(state)([IDENT]) and _not_(check(state)([PIPE, EOF])) else Ok((fields, state))

def parseGadtDecl(state):
    return __helper_69(expect(state)(IDENT)('Expected type name'))

def parseGadtConstructors(state):
    return lambda ctors: Ok((ctors, state)) if check(state)([RBRACE]) else __helper_72(expect(state)(IDENT)('Expected constructor name'))

def parseGadtFields(state):
    return lambda fields: __helper_73(parseTypeRef(state)) if check(state)([IDENT]) else Ok((fields, state))

def parseImportDecl(state):
    return ((((__helper_78(expect(s1)(IDENT)('Expected module name'))) if (s1 := (advance(state) if isPython else state)) is not None else None)) if (isPython := (check(state)([IDENT]) and getTokenString(current(state)) == 'python')) is not None else None)

def parseModulePath(state):
    return lambda parts: __helper_81(matchToken(state)([DOT]))

def parseInterfaceDecl(state):
    return __helper_87(expect(state)(IDENT)('Expected interface name'))

def parseInterfaceMethods(state):
    return lambda methods: Ok((methods, state)) if check(state)([RBRACE]) else __helper_91(expect(state)(IDENT)('Expected method name'))

def parseImplDecl(state):
    return __helper_97(expect(state)(IDENT)('Expected class name'))

def parseImplMethods(state):
    return lambda methods: Ok((methods, state)) if check(state)([RBRACE]) else __helper_102(expect(state)(IDENT)('Expected method name'))

def parseEffectDecl(state):
    return __helper_106(expect(state)(IDENT)('Expected effect name'))

def parseEffectOps(state):
    return lambda ops: Ok((ops, state)) if check(state)([RBRACE]) else __helper_110(expect(state)(IDENT)('Expected operation name'))

def parseTypeRef(state):
    return parseTypeArrow(state)

def parseTypeArrow(state):
    return __helper_114(parseTypeApp(state))

def parseTypeApp(state):
    return __helper_117(parseTypeAtom(state))

def parseTypeArgs(state):
    return lambda args: __helper_118(parseTypeAtom(state)) if check(state)([IDENT]) else Ok((args, state))

def parseTypeAtom(state):
    return __helper_133(matchToken(state)([LPAREN]))

def parseTupleTypes(state):
    return lambda elements: Ok((elements, state)) if check(state)([RPAREN]) else __helper_135(parseTypeRef(state))

def parseRecordType(state):
    return __helper_136(expect(state)(RBRACE)("Expected '}' after record type")) if check(state)([RBRACE]) else __helper_138(parseRecordFields(state)([]))

def parseRecordFields(state):
    return lambda fields: __helper_142(expect(state)(IDENT)('Expected field name'))

def parseExpr(state):
    return parseLet(state)

def parseLet(state):
    return __helper_150(matchToken(state)([KW_LET]))

def parseLetParams(state):
    return lambda params: __helper_155(matchToken(state)([LPAREN])) if check(state)([IDENT, LPAREN]) else Ok((params, state))

def parseDo(state):
    return __helper_160(matchToken(state)([KW_DO]))

def parseDoBindings(state):
    return lambda bindings: Ok((bindings, state)) if check(state)([KW_IN]) else __helper_163(expect(state)(IDENT)('Expected variable name in do binding'))

def parseIf(state):
    return __helper_170(matchToken(state)([KW_IF]))

def parseMatch(state):
    return __helper_175(matchToken(state)([KW_MATCH]))

def parseMatchCases(state):
    return lambda cases: __helper_185(matchToken(state)([PIPE]))

def parseOr(state):
    return __helper_187(parseAnd(state))

def parseOrLoop(state):
    return lambda left: __helper_190(matchToken(state)([DOUBLE_PIPE]))

def parseAnd(state):
    return __helper_192(parseComparison(state))

def parseAndLoop(state):
    return lambda left: __helper_195(matchToken(state)([DOUBLE_AMP]))

def parseComparison(state):
    return __helper_197(parseCons(state))

def parseComparisonLoop(state):
    return lambda left: __helper_200(matchToken(state)([EQ, NEQ, LT, LE, GT, GE]))

def parseCons(state):
    return __helper_204(parseConcat(state))

def parseConcat(state):
    return __helper_206(parseAdditive(state))

def parseConcatLoop(state):
    return lambda left: __helper_209(matchToken(state)([DOUBLE_PLUS]))

def parseAdditive(state):
    return __helper_211(parseMultiplicative(state))

def parseAdditiveLoop(state):
    return lambda left: __helper_214(matchToken(state)([PLUS, MINUS]))

def parseMultiplicative(state):
    return __helper_216(parseUnary(state))

def parseMultiplicativeLoop(state):
    return lambda left: __helper_219(matchToken(state)([STAR, SLASH, PERCENT]))

def parseUnary(state):
    return __helper_222(matchToken(state)([MINUS, BANG]))

def parseApplication(state):
    return __helper_224(parseAccess(state))

def parseApplicationLoop(state):
    return lambda expr: __helper_228(matchToken(state)([LPAREN]))

def parseAppArgs(state):
    return lambda args: __helper_231(parseExpr(state))

def applyArgs(func):
    return lambda args: __helper_232(args)

def parseAccess(state):
    return __helper_234(parseAtom(state))

def parseAccessLoop(state):
    return lambda expr: __helper_241(matchToken(state)([DOT]))

def parseAtom(state):
    return __helper_270(matchToken(state)([INT]))

def parseLambda(state):
    return __helper_281(matchToken(state)([LPAREN]))

def parseLambdaParams(state):
    return lambda params: __helper_284(parseParam(state))

def parseLambdaParamsNoParens(state):
    return lambda params: ((__helper_285(parseParam(state)) if List.member(peekTok.tokenType)([IDENT, FAT_ARROW, COLON, LPAREN]) else Ok((params, state))) if (peekTok := (peek(state))) is not None else None) if check(state)([IDENT]) else Ok((params, state))

def parseTupleElements(state):
    return lambda elements: Ok((elements, state)) if check(state)([RPAREN]) else __helper_287(parseExpr(state))

def parseListElements(state):
    return lambda elements: __helper_290(parseExpr(state))

def parseRecord(state):
    return __helper_294(expect(state)(IDENT)('Expected record name')) if check(state)([IDENT]) and peek(state).tokenType == KW_WITH else Ok((RecordLit([]), advance(state))) if check(state)([RBRACE]) else __helper_296(parseRecordFieldsExpr(state)([]))

def parseRecordFieldsExpr(state):
    return lambda fields: __helper_300(expect(state)(IDENT)('Expected field name'))

def parseRecordUpdates(state):
    return lambda updates: Ok((updates, state)) if check(state)([RBRACE]) else __helper_304(expect(state)(IDENT)('Expected field name'))

def parsePattern(state):
    return parseConsPattern(state)

def parseConsPattern(state):
    return __helper_308(parseAtomPattern(state))

def parseAtomPattern(state):
    return __helper_335(matchToken(state)([INT]))

def parsePatternListElements(state):
    return lambda elements: __helper_338(parsePattern(state))

def parsePatternTupleElements(state):
    return lambda elements: Ok((elements, state)) if check(state)([RPAREN]) else __helper_340(parsePattern(state))


# Helper functions to avoid deep nesting
def __helper_0(__match_val):
    return ((__match_val._field0 if isinstance(__match_val, Just) else None)) or ((0 if __match_val is Nothing else None))
def __helper_1(__match_val):
    return ((__match_val._field0 if isinstance(__match_val, Just) else None)) or ((Record({"tokenType": EOF, "value": NoValue, "span": Record({"start": 0, "end": 0, "line": 1, "column": 1})}) if __match_val is Nothing else None))
def __helper_2(__match_val):
    return ((__match_val._field0 if isinstance(__match_val, Just) else None)) or ((__helper_1(List.last(state.tokens)) if __match_val is Nothing else None))
def __helper_3(__match_val):
    return ((__match_val._field0 if isinstance(__match_val, Just) else None)) or ((current(state) if __match_val is Nothing else None))
def __helper_4(__match_val):
    return ((Ok((__match_val._field0, newState)) if isinstance(__match_val, Just) else None)) or ((Err(parseError(message)(current(state))) if __match_val is Nothing else None))
def __helper_5(__let_val_0):
    return (lambda mtok, newState: __helper_4(mtok))(__let_val_0[0], __let_val_0[1]) if isinstance(__let_val_0, tuple) and len(__let_val_0) == 2 else None
def __helper_6(__match_val):
    return ((__match_val._field0 if isinstance(__match_val, StringValue) else None)) or ('')
def __helper_7(__match_val):
    return ((__match_val._field0 if isinstance(__match_val, IntValue) else None)) or (0)
def __helper_8(__match_val):
    return ((__match_val._field0 if isinstance(__match_val, FloatValue) else None)) or (0.0)
def __helper_9(__match_val):
    return ((__match_val._field0 if isinstance(__match_val, CharValue) else None)) or ('\x00')
def __helper_10(__match_val):
    return ((parseDeclarations(__match_val._field0[1])([__match_val._field0[0]] + decls) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_11(__match_val):
    return ((parseDecorator(s8) if isinstance(__match_val, Just) else None)) or ((Err(parseError('Unexpected token: ' + tokenTypeName(current(state).tokenType))(current(state))) if __match_val is Nothing else None))
def __helper_12(__let_val_1):
    return (lambda mAt, s8: __helper_11(mAt))(__let_val_1[0], __let_val_1[1]) if isinstance(__let_val_1, tuple) and len(__let_val_1) == 2 else None
def __helper_13(__match_val):
    return ((parseEffectDecl(s7) if isinstance(__match_val, Just) else None)) or ((__helper_12(matchToken(state)([AT])) if __match_val is Nothing else None))
def __helper_14(__let_val_2):
    return (lambda mEffect, s7: __helper_13(mEffect))(__let_val_2[0], __let_val_2[1]) if isinstance(__let_val_2, tuple) and len(__let_val_2) == 2 else None
def __helper_15(__match_val):
    return ((parseImplDecl(s6) if isinstance(__match_val, Just) else None)) or ((__helper_14(matchToken(state)([KW_EFFECT])) if __match_val is Nothing else None))
def __helper_16(__let_val_3):
    return (lambda mImpl, s6: __helper_15(mImpl))(__let_val_3[0], __let_val_3[1]) if isinstance(__let_val_3, tuple) and len(__let_val_3) == 2 else None
def __helper_17(__match_val):
    return ((parseInterfaceDecl(s5) if isinstance(__match_val, Just) else None)) or ((__helper_16(matchToken(state)([KW_IMPL])) if __match_val is Nothing else None))
def __helper_18(__let_val_4):
    return (lambda mInterface, s5: __helper_17(mInterface))(__let_val_4[0], __let_val_4[1]) if isinstance(__let_val_4, tuple) and len(__let_val_4) == 2 else None
def __helper_19(__match_val):
    return ((parseImportDecl(s4) if isinstance(__match_val, Just) else None)) or ((__helper_18(matchToken(state)([KW_INTERFACE])) if __match_val is Nothing else None))
def __helper_20(__let_val_5):
    return (lambda mImport, s4: __helper_19(mImport))(__let_val_5[0], __let_val_5[1]) if isinstance(__let_val_5, tuple) and len(__let_val_5) == 2 else None
def __helper_21(__match_val):
    return ((parseGadtDecl(s3) if isinstance(__match_val, Just) else None)) or ((__helper_20(matchToken(state)([KW_IMPORT])) if __match_val is Nothing else None))
def __helper_22(__let_val_6):
    return (lambda mGadt, s3: __helper_21(mGadt))(__let_val_6[0], __let_val_6[1]) if isinstance(__let_val_6, tuple) and len(__let_val_6) == 2 else None
def __helper_23(__match_val):
    return ((parseTypeDecl(s2) if isinstance(__match_val, Just) else None)) or ((__helper_22(matchToken(state)([KW_GADT])) if __match_val is Nothing else None))
def __helper_24(__let_val_7):
    return (lambda mType, s2: __helper_23(mType))(__let_val_7[0], __let_val_7[1]) if isinstance(__let_val_7, tuple) and len(__let_val_7) == 2 else None
def __helper_25(__match_val):
    return ((parseDef(s1)(False)(Nothing) if isinstance(__match_val, Just) else None)) or ((__helper_24(matchToken(state)([KW_TYPE])) if __match_val is Nothing else None))
def __helper_26(__let_val_8):
    return (lambda mDef, s1: __helper_25(mDef))(__let_val_8[0], __let_val_8[1]) if isinstance(__let_val_8, tuple) and len(__let_val_8) == 2 else None
def __helper_27(__match_val):
    return ((parseDef(__match_val._field0[1])(True)(Nothing) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_28(__match_val):
    return ((((parseDef(__match_val._field0[1])(True)(Just(exportName))) if (exportName := (getTokenString(nameTok))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_27(expect(s3)(KW_DEF)("Expected 'def' after @py.export")) if __match_val is Nothing else None))
def __helper_29(__match_val):
    return (__helper_28(expect(__match_val._field0[1])(KW_DEF)("Expected 'def' after @py.export")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_30(__match_val):
    return (__helper_29(expect(__match_val._field0[1])(RPAREN)("Expected ')'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_31(__match_val):
    return (__helper_30(expect(s4)(STRING)('Expected export name')) if isinstance(__match_val, Just) else None)
def __helper_32(__let_val_9):
    return (lambda mLParen, s4: __helper_31(mLParen))(__let_val_9[0], __let_val_9[1]) if isinstance(__let_val_9, tuple) and len(__let_val_9) == 2 else None
def __helper_33(__match_val):
    return ((Ok((DefDecl(Record({"name": name, "params": params, "__match_val._field0[0]": __match_val._field0[0], "returnType": retType, "isExported": isExported, "exportName": exportName})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_34(__match_val):
    return (__helper_33(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_35(__match_val):
    return (__helper_34(expect(__match_val._field0[1])(EQUALS)("Expected '=' after function signature")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_36(__match_val):
    return (__helper_35(parseReturnType(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_37(__match_val):
    return (((__helper_36(parseParams(__match_val._field0[1]))) if (name := (getTokenString(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_38(__match_val):
    return ((Ok(([], advance(s1))) if check(s1)([RPAREN]) else parseParamList(s1)([]) if isinstance(__match_val, Just) else None)) or ((Ok(([], state)) if __match_val is Nothing else None))
def __helper_39(__let_val_10):
    return (lambda mLParen, s1: __helper_38(mLParen))(__let_val_10[0], __let_val_10[1]) if isinstance(__let_val_10, tuple) and len(__let_val_10) == 2 else None
def __helper_40(__match_val):
    return ((Ok((params + [param], __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_41(__match_val):
    return ((parseParamList(s2)(params + [param]) if isinstance(__match_val, Just) else None)) or ((__helper_40(expect(s1)(RPAREN)("Expected ')' after parameters")) if __match_val is Nothing else None))
def __helper_42(__let_val_11):
    return (lambda mComma, s2: __helper_41(mComma))(__let_val_11[0], __let_val_11[1]) if isinstance(__let_val_11, tuple) and len(__let_val_11) == 2 else None
def __helper_43(__match_val):
    return (__helper_42(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_44(__match_val):
    return ((Ok((Record({"name": name, "typeAnnotation": Just(__match_val._field0[0])}), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((Record({"name": name, "typeAnnotation": Nothing}), s1)) if __match_val is Nothing else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_45(__match_val):
    return (__helper_44(parseTypeRef(s2)) if isinstance(__match_val, Just) else None)
def __helper_46(__let_val_12):
    return (lambda mColon, s2: __helper_45(mColon))(__let_val_12[0], __let_val_12[1]) if isinstance(__let_val_12, tuple) and len(__let_val_12) == 2 else None
def __helper_47(__match_val):
    return (((__helper_46(matchToken(__match_val._field0[1])([COLON]))) if (name := (getTokenString(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_48(__match_val):
    return ((Ok((Just(__match_val._field0[0]), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((Nothing, state)) if __match_val is Nothing else None))
def __helper_49(__match_val):
    return (__helper_48(parseTypeRef(s1)) if isinstance(__match_val, Just) else None)
def __helper_50(__let_val_13):
    return (lambda mArrow, s1: __helper_49(mArrow))(__let_val_13[0], __let_val_13[1]) if isinstance(__let_val_13, tuple) and len(__let_val_13) == 2 else None
def __helper_51(__match_val):
    return ((Ok((TypeDecl(Record({"name": name, "params": params, "constructors": __match_val._field0[0], "isRecord": False, "recordFields": [], "isGadt": False})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_52(__match_val):
    return ((Ok((TypeDecl(Record({"name": name, "params": params, "constructors": __match_val._field0[0], "isRecord": False, "recordFields": [], "isGadt": False})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_51(parseConstructors(s2)([])) if __match_val is Nothing else None))
def __helper_53(__match_val):
    return ((Ok((TypeDecl(Record({"name": name, "params": params, "constructors": [], "isRecord": True, "recordFields": __match_val._field0.fields, "isGadt": False})), s4)) if isinstance(__match_val, RecordTypeRef) else None)) or (__helper_52(parseConstructors(s3)([])))
def __helper_54(__match_val):
    return (__helper_53(__match_val._field0[0]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_55(__match_val):
    return (__helper_54(parseTypeRef(s3)) if isinstance(__match_val, Just) else None)
def __helper_56(__let_val_14):
    return (lambda mEquals, s3: __helper_55(mEquals))(__let_val_14[0], __let_val_14[1]) if isinstance(__let_val_14, tuple) and len(__let_val_14) == 2 else None
def __helper_57(__match_val):
    return (__helper_56(matchToken(__match_val._field0[1])([EQUALS])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_58(__match_val):
    return (((__helper_57(parseTypeParams(__match_val._field0[1]))) if (name := (getTokenString(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_59(__match_val):
    return ((parseConstructors(__match_val._field0[1])(ctors + [Record({"name": name, "__match_val._field0[0]": __match_val._field0[0]})]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((ctors, state)) if __match_val is Nothing else None))
def __helper_60(__match_val):
    return (((__helper_59(parseConstructorFields(__match_val._field0[1])([]))) if (name := (getTokenString(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_61(__match_val):
    return (__helper_60(expect(s1)(IDENT)('Expected constructor name')) if isinstance(__match_val, Just) else None)
def __helper_62(__let_val_15):
    return (lambda mPipe, s1: __helper_61(mPipe))(__let_val_15[0], __let_val_15[1]) if isinstance(__let_val_15, tuple) and len(__let_val_15) == 2 else None
def __helper_63(__match_val):
    return ((parseConstructorFields(__match_val._field0[1])(fields + [__match_val._field0[0]]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_64(__match_val):
    return ((Ok((TypeDecl(Record({"name": name, "params": params, "constructors": ctors, "isRecord": False, "recordFields": [], "isGadt": True})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_65(__match_val):
    return (__helper_64(expect(__match_val._field0[1])(RBRACE)("Expected '}'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_66(__match_val):
    return (__helper_65(parseGadtConstructors(__match_val._field0[1])([])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_67(__match_val):
    return (__helper_66(expect(__match_val._field0[1])(LBRACE)("Expected '{'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_68(__match_val):
    return (__helper_67(expect(__match_val._field0[1])(KW_WHERE)("Expected 'where'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_69(__match_val):
    return (((__helper_68(parseTypeParams(__match_val._field0[1]))) if (name := (getTokenString(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_70(__let_val_16):
    return (lambda mComma, s3: parseGadtConstructors(s3)(ctors + [Record({"name": name, "fields": fields})]))(__let_val_16[0], __let_val_16[1]) if isinstance(__let_val_16, tuple) and len(__let_val_16) == 2 else None
def __helper_71(__match_val):
    return ((__helper_70(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_72(__match_val):
    return (((__helper_71(parseGadtFields(__match_val._field0[1])([]))) if (name := (getTokenString(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_73(__match_val):
    return ((parseGadtFields(__match_val._field0[1])(fields + [__match_val._field0[0]]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_74(__match_val):
    return ((Ok((ImportDecl(Record({"module": moduleName, "alias": Just(getTokenString(__match_val._field0[0])), "exposing": Nothing, "isPython": isPython})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((ImportDecl(Record({"module": moduleName, "alias": Nothing, "exposing": Nothing, "isPython": isPython})), s4)) if __match_val is Nothing else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_75(__match_val):
    return (__helper_74(expect(s4)(IDENT)('Expected alias')) if isinstance(__match_val, Just) else None)
def __helper_76(__let_val_17):
    return (lambda mAs, s4: __helper_75(mAs))(__let_val_17[0], __let_val_17[1]) if isinstance(__let_val_17, tuple) and len(__let_val_17) == 2 else None
def __helper_77(__match_val):
    return (((__helper_76(matchToken(__match_val._field0[1])([KW_AS]))) if (moduleName := (String.join('.')(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_78(__match_val):
    return (((__helper_77(parseModulePath(__match_val._field0[1])([firstPartName]))) if (firstPartName := (getTokenString(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_79(__match_val):
    return ((parseModulePath(__match_val._field0[1])(parts + [getTokenString(__match_val._field0[0])]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((parts, state)) if __match_val is Nothing else None))
def __helper_80(__match_val):
    return (__helper_79(expect(s1)(IDENT)('Expected module part')) if isinstance(__match_val, Just) else None)
def __helper_81(__let_val_18):
    return (lambda mDot, s1: __helper_80(mDot))(__let_val_18[0], __let_val_18[1]) if isinstance(__let_val_18, tuple) and len(__let_val_18) == 2 else None
def __helper_82(__match_val):
    return ((Ok((InterfaceDecl(Record({"name": name, "params": params, "methods": methods, "superclasses": []})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_83(__match_val):
    return (__helper_82(expect(__match_val._field0[1])(RBRACE)("Expected '}'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_84(__match_val):
    return (__helper_83(parseInterfaceMethods(__match_val._field0[1])([])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_85(__match_val):
    return (__helper_84(expect(__match_val._field0[1])(LBRACE)("Expected '{'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_86(__match_val):
    return (__helper_85(expect(__match_val._field0[1])(KW_WHERE)("Expected 'where'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_87(__match_val):
    return (((__helper_86(parseTypeParams(__match_val._field0[1]))) if (name := (getTokenString(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_88(__let_val_19):
    return (lambda mComma, s4: parseInterfaceMethods(s4)(methods + [Record({"name": getTokenString(nameTok), "typ": typeRef})]))(__let_val_19[0], __let_val_19[1]) if isinstance(__let_val_19, tuple) and len(__let_val_19) == 2 else None
def __helper_89(__match_val):
    return ((__helper_88(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_90(__match_val):
    return (__helper_89(parseTypeRef(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_91(__match_val):
    return (__helper_90(expect(__match_val._field0[1])(COLON)("Expected ':'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_92(__match_val):
    return ((Ok((ImplDecl(Record({"className": className, "typeRef": typeRef, "methods": methods})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_93(__match_val):
    return (__helper_92(expect(__match_val._field0[1])(RBRACE)("Expected '}'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_94(__match_val):
    return (__helper_93(parseImplMethods(__match_val._field0[1])([])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_95(__match_val):
    return (__helper_94(expect(__match_val._field0[1])(LBRACE)("Expected '{'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_96(__match_val):
    return (__helper_95(expect(__match_val._field0[1])(KW_WHERE)("Expected 'where'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_97(__match_val):
    return (((__helper_96(parseTypeRef(__match_val._field0[1]))) if (className := (getTokenString(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_98(__let_val_20):
    return (lambda mComma, s5: parseImplMethods(s5)(methods + [Record({"name": getTokenString(nameTok), "params": params, "body": body})]))(__let_val_20[0], __let_val_20[1]) if isinstance(__let_val_20, tuple) and len(__let_val_20) == 2 else None
def __helper_99(__match_val):
    return ((__helper_98(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_100(__match_val):
    return (__helper_99(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_101(__match_val):
    return (__helper_100(expect(__match_val._field0[1])(EQUALS)("Expected '='")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_102(__match_val):
    return (__helper_101(parseParams(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_103(__match_val):
    return ((Ok((EffectDecl(Record({"name": name, "operations": ops})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_104(__match_val):
    return (__helper_103(expect(__match_val._field0[1])(RBRACE)("Expected '}'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_105(__match_val):
    return (__helper_104(parseEffectOps(__match_val._field0[1])([])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_106(__match_val):
    return (((__helper_105(expect(__match_val._field0[1])(LBRACE)("Expected '{'"))) if (name := (getTokenString(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_107(__let_val_21):
    return (lambda mComma, s4: parseEffectOps(s4)(ops + [Record({"name": getTokenString(nameTok), "typ": typeRef})]))(__let_val_21[0], __let_val_21[1]) if isinstance(__let_val_21, tuple) and len(__let_val_21) == 2 else None
def __helper_108(__match_val):
    return ((__helper_107(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_109(__match_val):
    return (__helper_108(parseTypeRef(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_110(__match_val):
    return (__helper_109(expect(__match_val._field0[1])(COLON)("Expected ':'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_111(__match_val):
    return ((Ok((FunTypeRef(Record({"param": left, "result": __match_val._field0[0]})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((left, s1)) if __match_val is Nothing else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_112(__match_val):
    return (__helper_111(parseTypeArrow(s2)) if isinstance(__match_val, Just) else None)
def __helper_113(__let_val_22):
    return (lambda mArrow, s2: __helper_112(mArrow))(__let_val_22[0], __let_val_22[1]) if isinstance(__let_val_22, tuple) and len(__let_val_22) == 2 else None
def __helper_114(__match_val):
    return (__helper_113(matchToken(__match_val._field0[1])([ARROW])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_115(__match_val):
    return ((Ok((SimpleTypeRef(Record({"name": __match_val._field0.name, "args": args})), s2)) if isinstance(__match_val, SimpleTypeRef) else None)) or (Ok((base, s2))) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_116(__match_val):
    return (Ok((base, __match_val._field0[1])) if List.isEmpty(__match_val._field0[0]) else __helper_115(base) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_117(__match_val):
    return (__helper_116(parseTypeArgs(__match_val._field0[1])([])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_118(__match_val):
    return ((parseTypeArgs(__match_val._field0[1])(args + [__match_val._field0[0]]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_119(__match_val):
    return ((Ok((SimpleTypeRef(Record({"name": getTokenString(__match_val._field0[0]), "args": []})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_120(__match_val):
    return ((parseRecordType(s3) if isinstance(__match_val, Just) else None)) or ((__helper_119(expect(state)(IDENT)('Expected type name')) if __match_val is Nothing else None))
def __helper_121(__let_val_23):
    return (lambda mLBrace, s3: __helper_120(mLBrace))(__let_val_23[0], __let_val_23[1]) if isinstance(__let_val_23, tuple) and len(__let_val_23) == 2 else None
def __helper_122(__match_val):
    return ((Ok((SimpleTypeRef(Record({"name": 'List', "args": [elemType]})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_121(matchToken(state)([LBRACE])) if __match_val is Nothing else None))
def __helper_123(__match_val):
    return (__helper_122(expect(__match_val._field0[1])(RBRACKET)("Expected ']' after list type")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_124(__match_val):
    return (__helper_123(parseTypeRef(s2)) if isinstance(__match_val, Just) else None)
def __helper_125(__let_val_24):
    return (lambda mLBracket, s2: __helper_124(mLBracket))(__let_val_24[0], __let_val_24[1]) if isinstance(__let_val_24, tuple) and len(__let_val_24) == 2 else None
def __helper_126(__match_val):
    return ((Ok((inner, __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_125(matchToken(state)([LBRACKET])) if __match_val is Nothing else None))
def __helper_127(__match_val):
    return ((Ok((TupleTypeRef(Record({"elements": elements})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_126(expect(s2)(RPAREN)("Expected ')'")) if __match_val is Nothing else None))
def __helper_128(__match_val):
    return (__helper_127(expect(__match_val._field0[1])(RPAREN)("Expected ')' after tuple type")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_129(__match_val):
    return (__helper_128(parseTupleTypes(s3)([inner])) if isinstance(__match_val, Just) else None)
def __helper_130(__let_val_25):
    return (lambda mComma, s3: __helper_129(mComma))(__let_val_25[0], __let_val_25[1]) if isinstance(__let_val_25, tuple) and len(__let_val_25) == 2 else None
def __helper_131(__match_val):
    return (__helper_130(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_132(__match_val):
    return (Ok((TupleTypeRef(Record({"elements": []})), advance(s1))) if check(s1)([RPAREN]) else __helper_131(parseTypeRef(s1)) if isinstance(__match_val, Just) else None)
def __helper_133(__let_val_26):
    return (lambda mLParen, s1: __helper_132(mLParen))(__let_val_26[0], __let_val_26[1]) if isinstance(__let_val_26, tuple) and len(__let_val_26) == 2 else None
def __helper_134(__let_val_27):
    return (lambda mComma, s2: parseTupleTypes(s2)(elements + [typeRef]))(__let_val_27[0], __let_val_27[1]) if isinstance(__let_val_27, tuple) and len(__let_val_27) == 2 else None
def __helper_135(__match_val):
    return ((__helper_134(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_136(__match_val):
    return ((Ok((RecordTypeRef(Record({"fields": []})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_137(__match_val):
    return ((Ok((RecordTypeRef(Record({"fields": fields})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_138(__match_val):
    return (__helper_137(expect(__match_val._field0[1])(RBRACE)("Expected '}' after record type")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_139(__let_val_28):
    return (lambda mComma, s4: Ok((fields + [(getTokenString(nameTok), typeRef)], s4)) if check(s4)([RBRACE]) else parseRecordFields(s4)(fields + [(getTokenString(nameTok), typeRef)]))(__let_val_28[0], __let_val_28[1]) if isinstance(__let_val_28, tuple) and len(__let_val_28) == 2 else None
def __helper_140(__match_val):
    return ((__helper_139(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_141(__match_val):
    return (__helper_140(parseTypeRef(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_142(__match_val):
    return (__helper_141(expect(__match_val._field0[1])(COLON)("Expected ':' after field name")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_143(__match_val):
    return ((Ok((Let(Record({"name": name, "value": value, "__match_val._field0[0]": __match_val._field0[0]})), __match_val._field0[1])) if List.isEmpty(params) else Ok((LetFunc(Record({"name": name, "params": params, "value": value, "__match_val._field0[0]": __match_val._field0[0]})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((parseDo(state) if __match_val is Nothing else None))
def __helper_144(__let_val_29):
    return (lambda mIn, s6: __helper_143(parseExpr(s6)))(__let_val_29[0], __let_val_29[1]) if isinstance(__let_val_29, tuple) and len(__let_val_29) == 2 else None
def __helper_145(__match_val):
    return (__helper_144(matchToken(__match_val._field0[1])([KW_IN])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_146(__match_val):
    return (__helper_145(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_147(__match_val):
    return (__helper_146(expect(__match_val._field0[1])(EQUALS)("Expected '=' after let binding")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_148(__match_val):
    return (((__helper_147(parseLetParams(__match_val._field0[1])([]))) if (name := (getTokenString(__match_val._field0[0]))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_149(__match_val):
    return (__helper_148(expect(s1)(IDENT)('Expected variable name')) if isinstance(__match_val, Just) else None)
def __helper_150(__let_val_30):
    return (lambda mLet, s1: __helper_149(mLet))(__let_val_30[0], __let_val_30[1]) if isinstance(__let_val_30, tuple) and len(__let_val_30) == 2 else None
def __helper_151(__match_val):
    return ((parseLetParams(__match_val._field0[1])(params + [__match_val._field0[0]]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_152(__match_val):
    return ((parseLetParams(__match_val._field0[1])(params + [param]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_151(parseParam(state)) if __match_val is Nothing else None))
def __helper_153(__match_val):
    return (__helper_152(expect(__match_val._field0[1])(RPAREN)("Expected ')'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_154(__match_val):
    return (__helper_153(parseParam(s1)) if isinstance(__match_val, Just) else None)
def __helper_155(__let_val_31):
    return (lambda mLParen, s1: __helper_154(mLParen))(__let_val_31[0], __let_val_31[1]) if isinstance(__let_val_31, tuple) and len(__let_val_31) == 2 else None
def __helper_156(__match_val):
    return ((Ok((DoNotation(Record({"bindings": bindings, "__match_val._field0[0]": __match_val._field0[0]})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((parseIf(state) if __match_val is Nothing else None))
def __helper_157(__let_val_32):
    return (lambda mIn, s3: __helper_156(parseExpr(s3)))(__let_val_32[0], __let_val_32[1]) if isinstance(__let_val_32, tuple) and len(__let_val_32) == 2 else None
def __helper_158(__match_val):
    return (__helper_157(matchToken(__match_val._field0[1])([KW_IN])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_159(__match_val):
    return (__helper_158(parseDoBindings(s1)([])) if isinstance(__match_val, Just) else None)
def __helper_160(__let_val_33):
    return (lambda mDo, s1: __helper_159(mDo))(__let_val_33[0], __let_val_33[1]) if isinstance(__let_val_33, tuple) and len(__let_val_33) == 2 else None
def __helper_161(__match_val):
    return ((parseDoBindings(__match_val._field0[1])(bindings + [Record({"name": getTokenString(nameTok), "__match_val._field0[0]": __match_val._field0[0]})]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_162(__let_val_34):
    return (lambda mArrow, s2: __helper_161(parseExpr(s2)))(__let_val_34[0], __let_val_34[1]) if isinstance(__let_val_34, tuple) and len(__let_val_34) == 2 else None
def __helper_163(__match_val):
    return (__helper_162(matchToken(__match_val._field0[1])([LEFT_ARROW])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_164(__match_val):
    return ((Ok((If(Record({"cond": cond, "thenBranch": thenBranch, "__match_val._field0[0]": __match_val._field0[0]})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((parseMatch(state) if __match_val is Nothing else None))
def __helper_165(__match_val):
    return (__helper_164(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_166(__match_val):
    return (__helper_165(expect(__match_val._field0[1])(KW_ELSE)("Expected 'else'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_167(__match_val):
    return (__helper_166(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_168(__match_val):
    return (__helper_167(expect(__match_val._field0[1])(KW_THEN)("Expected 'then'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_169(__match_val):
    return (__helper_168(parseExpr(s1)) if isinstance(__match_val, Just) else None)
def __helper_170(__let_val_35):
    return (lambda mIf, s1: __helper_169(mIf))(__let_val_35[0], __let_val_35[1]) if isinstance(__let_val_35, tuple) and len(__let_val_35) == 2 else None
def __helper_171(__match_val):
    return ((Ok((Match(Record({"scrutinee": scrutinee, "__match_val._field0[0]": __match_val._field0[0]})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((parseOr(state) if __match_val is Nothing else None))
def __helper_172(__match_val):
    return (__helper_171(parseMatchCases(__match_val._field0[1])([])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_173(__match_val):
    return (__helper_172(expect(__match_val._field0[1])(KW_WITH)("Expected 'with'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_174(__match_val):
    return (__helper_173(parseExpr(s1)) if isinstance(__match_val, Just) else None)
def __helper_175(__let_val_36):
    return (lambda mMatch, s1: __helper_174(mMatch))(__let_val_36[0], __let_val_36[1]) if isinstance(__let_val_36, tuple) and len(__let_val_36) == 2 else None
def __helper_176(__match_val):
    return ((parseMatchCases(__match_val._field0[1])(cases + [Record({"pattern": pattern, "__match_val._field0[0]": __match_val._field0[0], "guard": Nothing})]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((cases, state)) if __match_val is Nothing else None))
def __helper_177(__match_val):
    return (__helper_176(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_178(__match_val):
    return ((parseMatchCases(__match_val._field0[1])(cases + [Record({"pattern": pattern, "__match_val._field0[0]": __match_val._field0[0], "guard": Just(guard)})]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_177(expect(s3)(ARROW)("Expected '->'")) if __match_val is Nothing else None))
def __helper_179(__match_val):
    return (__helper_178(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_180(__match_val):
    return (__helper_179(expect(__match_val._field0[1])(ARROW)("Expected '->'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_181(__match_val):
    return (__helper_180(parseExpr(s3)) if isinstance(__match_val, Just) else None)
def __helper_182(__let_val_37):
    return (lambda mGuard, s3: __helper_181(mGuard))(__let_val_37[0], __let_val_37[1]) if isinstance(__let_val_37, tuple) and len(__let_val_37) == 2 else None
def __helper_183(__match_val):
    return (__helper_182(matchToken(__match_val._field0[1])([KW_IF])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_184(__match_val):
    return (__helper_183(parsePattern(s1)) if isinstance(__match_val, Just) else None)
def __helper_185(__let_val_38):
    return (lambda mPipe, s1: __helper_184(mPipe))(__let_val_38[0], __let_val_38[1]) if isinstance(__let_val_38, tuple) and len(__let_val_38) == 2 else None
def __helper_186(__match_val):
    return ((Ok((__match_val._field0[0], __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_187(__match_val):
    return (__helper_186(parseOrLoop(__match_val._field0[1])(__match_val._field0[0])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_188(__match_val):
    return ((parseOrLoop(__match_val._field0[1])(BinOp(Record({"left": left, "op": '||', "__match_val._field0[0]": __match_val._field0[0]}))) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((left, state)) if __match_val is Nothing else None))
def __helper_189(__match_val):
    return (__helper_188(parseAnd(s1)) if isinstance(__match_val, Just) else None)
def __helper_190(__let_val_39):
    return (lambda mOr, s1: __helper_189(mOr))(__let_val_39[0], __let_val_39[1]) if isinstance(__let_val_39, tuple) and len(__let_val_39) == 2 else None
def __helper_191(__match_val):
    return ((Ok((__match_val._field0[0], __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_192(__match_val):
    return (__helper_191(parseAndLoop(__match_val._field0[1])(__match_val._field0[0])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_193(__match_val):
    return ((parseAndLoop(__match_val._field0[1])(BinOp(Record({"left": left, "op": '&&', "__match_val._field0[0]": __match_val._field0[0]}))) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((left, state)) if __match_val is Nothing else None))
def __helper_194(__match_val):
    return (__helper_193(parseComparison(s1)) if isinstance(__match_val, Just) else None)
def __helper_195(__let_val_40):
    return (lambda mAnd, s1: __helper_194(mAnd))(__let_val_40[0], __let_val_40[1]) if isinstance(__let_val_40, tuple) and len(__let_val_40) == 2 else None
def __helper_196(__match_val):
    return ((Ok((__match_val._field0[0], __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_197(__match_val):
    return (__helper_196(parseComparisonLoop(__match_val._field0[1])(__match_val._field0[0])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_198(__match_val):
    return ((((parseComparisonLoop(__match_val._field0[1])(BinOp(Record({"left": left, "op": op, "__match_val._field0[0]": __match_val._field0[0]})))) if (op := (getTokenString(opTok))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((left, state)) if __match_val is Nothing else None))
def __helper_199(__match_val):
    return (__helper_198(parseCons(s1)) if isinstance(__match_val, Just) else None)
def __helper_200(__let_val_41):
    return (lambda mOp, s1: __helper_199(mOp))(__let_val_41[0], __let_val_41[1]) if isinstance(__let_val_41, tuple) and len(__let_val_41) == 2 else None
def __helper_201(__match_val):
    return ((Ok((BinOp(Record({"left": left, "op": '::', "__match_val._field0[0]": __match_val._field0[0]})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((left, s1)) if __match_val is Nothing else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_202(__match_val):
    return (__helper_201(parseCons(s2)) if isinstance(__match_val, Just) else None)
def __helper_203(__let_val_42):
    return (lambda mCons, s2: __helper_202(mCons))(__let_val_42[0], __let_val_42[1]) if isinstance(__let_val_42, tuple) and len(__let_val_42) == 2 else None
def __helper_204(__match_val):
    return (__helper_203(matchToken(__match_val._field0[1])([DOUBLE_COLON])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_205(__match_val):
    return ((Ok((__match_val._field0[0], __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_206(__match_val):
    return (__helper_205(parseConcatLoop(__match_val._field0[1])(__match_val._field0[0])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_207(__match_val):
    return ((parseConcatLoop(__match_val._field0[1])(BinOp(Record({"left": left, "op": '++', "__match_val._field0[0]": __match_val._field0[0]}))) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((left, state)) if __match_val is Nothing else None))
def __helper_208(__match_val):
    return (__helper_207(parseAdditive(s1)) if isinstance(__match_val, Just) else None)
def __helper_209(__let_val_43):
    return (lambda mConcat, s1: __helper_208(mConcat))(__let_val_43[0], __let_val_43[1]) if isinstance(__let_val_43, tuple) and len(__let_val_43) == 2 else None
def __helper_210(__match_val):
    return ((Ok((__match_val._field0[0], __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_211(__match_val):
    return (__helper_210(parseAdditiveLoop(__match_val._field0[1])(__match_val._field0[0])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_212(__match_val):
    return ((((parseAdditiveLoop(__match_val._field0[1])(BinOp(Record({"left": left, "op": op, "__match_val._field0[0]": __match_val._field0[0]})))) if (op := (getTokenString(opTok))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((left, state)) if __match_val is Nothing else None))
def __helper_213(__match_val):
    return (__helper_212(parseMultiplicative(s1)) if isinstance(__match_val, Just) else None)
def __helper_214(__let_val_44):
    return (lambda mOp, s1: __helper_213(mOp))(__let_val_44[0], __let_val_44[1]) if isinstance(__let_val_44, tuple) and len(__let_val_44) == 2 else None
def __helper_215(__match_val):
    return ((Ok((__match_val._field0[0], __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_216(__match_val):
    return (__helper_215(parseMultiplicativeLoop(__match_val._field0[1])(__match_val._field0[0])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_217(__match_val):
    return ((((parseMultiplicativeLoop(__match_val._field0[1])(BinOp(Record({"left": left, "op": op, "__match_val._field0[0]": __match_val._field0[0]})))) if (op := (getTokenString(opTok))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((left, state)) if __match_val is Nothing else None))
def __helper_218(__match_val):
    return (__helper_217(parseUnary(s1)) if isinstance(__match_val, Just) else None)
def __helper_219(__let_val_45):
    return (lambda mOp, s1: __helper_218(mOp))(__let_val_45[0], __let_val_45[1]) if isinstance(__let_val_45, tuple) and len(__let_val_45) == 2 else None
def __helper_220(__match_val):
    return ((((Ok((UnaryOp(Record({"op": op, "__match_val._field0[0]": __match_val._field0[0]})), __match_val._field0[1]))) if (op := (getTokenString(opTok))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((parseApplication(state) if __match_val is Nothing else None))
def __helper_221(__match_val):
    return (__helper_220(parseUnary(s1)) if isinstance(__match_val, Just) else None)
def __helper_222(__let_val_46):
    return (lambda mOp, s1: __helper_221(mOp))(__let_val_46[0], __let_val_46[1]) if isinstance(__let_val_46, tuple) and len(__let_val_46) == 2 else None
def __helper_223(__match_val):
    return ((Ok((__match_val._field0[0], __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_224(__match_val):
    return (__helper_223(parseApplicationLoop(__match_val._field0[1])(__match_val._field0[0])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_225(__match_val):
    return ((((parseApplicationLoop(__match_val._field0[1])(applied)) if (applied := (applyArgs(expr)(args))) is not None else None) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((expr, state)) if __match_val is Nothing else None))
def __helper_226(__match_val):
    return (__helper_225(expect(__match_val._field0[1])(RPAREN)("Expected ')'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_227(__match_val):
    return (parseApplicationLoop(advance(s1))(expr) if check(s1)([RPAREN]) else __helper_226(parseAppArgs(s1)([])) if isinstance(__match_val, Just) else None)
def __helper_228(__let_val_47):
    return (lambda mLParen, s1: __helper_227(mLParen))(__let_val_47[0], __let_val_47[1]) if isinstance(__let_val_47, tuple) and len(__let_val_47) == 2 else None
def __helper_229(__match_val):
    return ((parseAppArgs(s2)(args + [arg]) if isinstance(__match_val, Just) else None)) or ((Ok((args + [arg], s1)) if __match_val is Nothing else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_230(__let_val_48):
    return (lambda mComma, s2: __helper_229(mComma))(__let_val_48[0], __let_val_48[1]) if isinstance(__let_val_48, tuple) and len(__let_val_48) == 2 else None
def __helper_231(__match_val):
    return (__helper_230(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_232(__match_val):
    return ((func if __match_val == [] else None)) or ((App(Record({"func": func, "args": [__match_val[0]]})) if isinstance(__match_val, list) and len(__match_val) == 1 else None)) or ((applyArgs(App(Record({"func": func, "args": [__match_val[0]]})))(rest) if isinstance(__match_val, list) and len(__match_val) == 1 else None))
def __helper_233(__match_val):
    return ((Ok((__match_val._field0[0], __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_234(__match_val):
    return (__helper_233(parseAccessLoop(__match_val._field0[1])(__match_val._field0[0])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_235(__match_val):
    return ((parseAccessLoop(__match_val._field0[1])(IndexAccess(Record({"expr": expr, "index": index}))) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((expr, state)) if __match_val is Nothing else None))
def __helper_236(__match_val):
    return (__helper_235(expect(__match_val._field0[1])(RBRACKET)("Expected ']'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_237(__match_val):
    return (__helper_236(parseExpr(s2)) if isinstance(__match_val, Just) else None)
def __helper_238(__let_val_49):
    return (lambda mLBracket, s2: __helper_237(mLBracket))(__let_val_49[0], __let_val_49[1]) if isinstance(__let_val_49, tuple) and len(__let_val_49) == 2 else None
def __helper_239(__match_val):
    return ((parseAccessLoop(__match_val._field0[1])(FieldAccess(Record({"expr": expr, "field": getTokenString(__match_val._field0[0])}))) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_238(matchToken(state)([LBRACKET])) if __match_val is Nothing else None))
def __helper_240(__match_val):
    return (__helper_239(expect(s1)(IDENT)('Expected field name')) if isinstance(__match_val, Just) else None)
def __helper_241(__let_val_50):
    return (lambda mDot, s1: __helper_240(mDot))(__let_val_50[0], __let_val_50[1]) if isinstance(__let_val_50, tuple) and len(__let_val_50) == 2 else None
def __helper_242(__match_val):
    return ((Ok((Var(getTokenString(__match_val._field0[0])), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_243(__match_val):
    return ((parseRecord(s10) if isinstance(__match_val, Just) else None)) or ((__helper_242(expect(state)(IDENT)('Unexpected token')) if __match_val is Nothing else None))
def __helper_244(__let_val_51):
    return (lambda mLBrace, s10: __helper_243(mLBrace))(__let_val_51[0], __let_val_51[1]) if isinstance(__let_val_51, tuple) and len(__let_val_51) == 2 else None
def __helper_245(__match_val):
    return ((Ok((ListLit(elements), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_244(matchToken(state)([LBRACE])) if __match_val is Nothing else None))
def __helper_246(__match_val):
    return (__helper_245(expect(__match_val._field0[1])(RBRACKET)("Expected ']'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_247(__match_val):
    return (Ok((ListLit([]), advance(s9))) if check(s9)([RBRACKET]) else __helper_246(parseListElements(s9)([])) if isinstance(__match_val, Just) else None)
def __helper_248(__let_val_52):
    return (lambda mLBracket, s9: __helper_247(mLBracket))(__let_val_52[0], __let_val_52[1]) if isinstance(__let_val_52, tuple) and len(__let_val_52) == 2 else None
def __helper_249(__match_val):
    return ((Ok((first, __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_248(matchToken(state)([LBRACKET])) if __match_val is Nothing else None))
def __helper_250(__match_val):
    return ((Ok((TupleLit(elements), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_249(expect(s9)(RPAREN)("Expected ')'")) if __match_val is Nothing else None))
def __helper_251(__match_val):
    return (__helper_250(expect(__match_val._field0[1])(RPAREN)("Expected ')'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_252(__match_val):
    return (__helper_251(parseTupleElements(s10)([first])) if isinstance(__match_val, Just) else None)
def __helper_253(__let_val_53):
    return (lambda mComma, s10: __helper_252(mComma))(__let_val_53[0], __let_val_53[1]) if isinstance(__let_val_53, tuple) and len(__let_val_53) == 2 else None
def __helper_254(__match_val):
    return (__helper_253(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_255(__match_val):
    return (Ok((UnitLit, advance(s8))) if check(s8)([RPAREN]) else __helper_254(parseExpr(s8)) if isinstance(__match_val, Just) else None)
def __helper_256(__let_val_54):
    return (lambda mLParen, s8: __helper_255(mLParen))(__let_val_54[0], __let_val_54[1]) if isinstance(__let_val_54, tuple) and len(__let_val_54) == 2 else None
def __helper_257(__match_val):
    return ((parseLambda(s7) if isinstance(__match_val, Just) else None)) or ((__helper_256(matchToken(state)([LPAREN])) if __match_val is Nothing else None))
def __helper_258(__let_val_55):
    return (lambda mFn, s7: __helper_257(mFn))(__let_val_55[0], __let_val_55[1]) if isinstance(__let_val_55, tuple) and len(__let_val_55) == 2 else None
def __helper_259(__match_val):
    return ((Ok((BoolLit(False), s6)) if isinstance(__match_val, Just) else None)) or ((__helper_258(matchToken(state)([KW_FN])) if __match_val is Nothing else None))
def __helper_260(__let_val_56):
    return (lambda mFalse, s6: __helper_259(mFalse))(__let_val_56[0], __let_val_56[1]) if isinstance(__let_val_56, tuple) and len(__let_val_56) == 2 else None
def __helper_261(__match_val):
    return ((Ok((BoolLit(True), s5)) if isinstance(__match_val, Just) else None)) or ((__helper_260(matchToken(state)([FALSE])) if __match_val is Nothing else None))
def __helper_262(__let_val_57):
    return (lambda mTrue, s5: __helper_261(mTrue))(__let_val_57[0], __let_val_57[1]) if isinstance(__let_val_57, tuple) and len(__let_val_57) == 2 else None
def __helper_263(__match_val):
    return ((Ok((CharLit(getTokenChar(__match_val._field0)), s4)) if isinstance(__match_val, Just) else None)) or ((__helper_262(matchToken(state)([TRUE])) if __match_val is Nothing else None))
def __helper_264(__let_val_58):
    return (lambda mChar, s4: __helper_263(mChar))(__let_val_58[0], __let_val_58[1]) if isinstance(__let_val_58, tuple) and len(__let_val_58) == 2 else None
def __helper_265(__match_val):
    return ((Ok((StringLit(getTokenString(__match_val._field0)), s3)) if isinstance(__match_val, Just) else None)) or ((__helper_264(matchToken(state)([CHAR])) if __match_val is Nothing else None))
def __helper_266(__let_val_59):
    return (lambda mString, s3: __helper_265(mString))(__let_val_59[0], __let_val_59[1]) if isinstance(__let_val_59, tuple) and len(__let_val_59) == 2 else None
def __helper_267(__match_val):
    return ((Ok((FloatLit(getTokenFloat(__match_val._field0)), s2)) if isinstance(__match_val, Just) else None)) or ((__helper_266(matchToken(state)([STRING])) if __match_val is Nothing else None))
def __helper_268(__let_val_60):
    return (lambda mFloat, s2: __helper_267(mFloat))(__let_val_60[0], __let_val_60[1]) if isinstance(__let_val_60, tuple) and len(__let_val_60) == 2 else None
def __helper_269(__match_val):
    return ((Ok((IntLit(getTokenInt(__match_val._field0)), s1)) if isinstance(__match_val, Just) else None)) or ((__helper_268(matchToken(state)([FLOAT])) if __match_val is Nothing else None))
def __helper_270(__let_val_61):
    return (lambda mInt, s1: __helper_269(mInt))(__let_val_61[0], __let_val_61[1]) if isinstance(__let_val_61, tuple) and len(__let_val_61) == 2 else None
def __helper_271(__match_val):
    return ((Ok((Lambda(Record({"params": [], "__match_val._field0[0]": __match_val._field0[0]})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_272(__match_val):
    return (__helper_271(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_273(__match_val):
    return ((Ok((Lambda(Record({"params": params, "__match_val._field0[0]": __match_val._field0[0]})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_274(__match_val):
    return (__helper_273(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_275(__match_val):
    return (__helper_274(expect(__match_val._field0[1])(FAT_ARROW)("Expected '=>'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_276(__match_val):
    return ((Ok((Lambda(Record({"params": params, "__match_val._field0[0]": __match_val._field0[0]})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_275(parseLambdaParamsNoParens(state)([])) if __match_val is Nothing else None))
def __helper_277(__match_val):
    return (__helper_276(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_278(__match_val):
    return (__helper_277(expect(__match_val._field0[1])(FAT_ARROW)("Expected '=>'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_279(__match_val):
    return (__helper_278(expect(__match_val._field0[1])(RPAREN)("Expected ')'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_280(__match_val):
    return (__helper_272(expect(advance(s1))(FAT_ARROW)("Expected '=>'")) if check(s1)([RPAREN]) else __helper_279(parseLambdaParams(s1)([])) if isinstance(__match_val, Just) else None)
def __helper_281(__let_val_62):
    return (lambda mLParen, s1: __helper_280(mLParen))(__let_val_62[0], __let_val_62[1]) if isinstance(__let_val_62, tuple) and len(__let_val_62) == 2 else None
def __helper_282(__match_val):
    return ((parseLambdaParams(s2)(params + [param]) if isinstance(__match_val, Just) else None)) or ((Ok((params + [param], s1)) if __match_val is Nothing else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_283(__let_val_63):
    return (lambda mComma, s2: __helper_282(mComma))(__let_val_63[0], __let_val_63[1]) if isinstance(__let_val_63, tuple) and len(__let_val_63) == 2 else None
def __helper_284(__match_val):
    return (__helper_283(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_285(__match_val):
    return ((parseLambdaParamsNoParens(__match_val._field0[1])(params + [__match_val._field0[0]]) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_286(__let_val_64):
    return (lambda mComma, s2: parseTupleElements(s2)(elements + [elem]))(__let_val_64[0], __let_val_64[1]) if isinstance(__let_val_64, tuple) and len(__let_val_64) == 2 else None
def __helper_287(__match_val):
    return ((__helper_286(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_288(__match_val):
    return ((parseListElements(s2)(elements + [elem]) if isinstance(__match_val, Just) else None)) or ((Ok((elements + [elem], s1)) if __match_val is Nothing else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_289(__let_val_65):
    return (lambda mComma, s2: __helper_288(mComma))(__let_val_65[0], __let_val_65[1]) if isinstance(__let_val_65, tuple) and len(__let_val_65) == 2 else None
def __helper_290(__match_val):
    return (__helper_289(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_291(__match_val):
    return ((Ok((RecordUpdate(Record({"record": Var(getTokenString(nameTok)), "updates": updates})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_292(__match_val):
    return (__helper_291(expect(__match_val._field0[1])(RBRACE)("Expected '}'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_293(__match_val):
    return (__helper_292(parseRecordUpdates(__match_val._field0[1])([])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_294(__match_val):
    return (__helper_293(expect(__match_val._field0[1])(KW_WITH)("Expected 'with'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_295(__match_val):
    return ((Ok((RecordLit(fields), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_296(__match_val):
    return (__helper_295(expect(__match_val._field0[1])(RBRACE)("Expected '}'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_297(__let_val_66):
    return (lambda mComma, s4: Ok((fields + [Record({"name": getTokenString(nameTok), "value": value})], s4)) if check(s4)([RBRACE]) else parseRecordFieldsExpr(s4)(fields + [Record({"name": getTokenString(nameTok), "value": value})]))(__let_val_66[0], __let_val_66[1]) if isinstance(__let_val_66, tuple) and len(__let_val_66) == 2 else None
def __helper_298(__match_val):
    return ((__helper_297(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_299(__match_val):
    return (__helper_298(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_300(__match_val):
    return (__helper_299(expect(__match_val._field0[1])(COLON)("Expected ':'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_301(__let_val_67):
    return (lambda mComma, s4: parseRecordUpdates(s4)(updates + [Record({"name": getTokenString(nameTok), "value": value})]))(__let_val_67[0], __let_val_67[1]) if isinstance(__let_val_67, tuple) and len(__let_val_67) == 2 else None
def __helper_302(__match_val):
    return ((__helper_301(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_303(__match_val):
    return (__helper_302(parseExpr(__match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_304(__match_val):
    return (__helper_303(expect(__match_val._field0[1])(EQUALS)("Expected '='")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_305(__match_val):
    return ((Ok((ConsPattern(Record({"head": left, "tail": __match_val._field0[0]})), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Ok((left, s1)) if __match_val is Nothing else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_306(__match_val):
    return (__helper_305(parseConsPattern(s2)) if isinstance(__match_val, Just) else None)
def __helper_307(__let_val_68):
    return (lambda mCons, s2: __helper_306(mCons))(__let_val_68[0], __let_val_68[1]) if isinstance(__let_val_68, tuple) and len(__let_val_68) == 2 else None
def __helper_308(__match_val):
    return (__helper_307(matchToken(__match_val._field0[1])([DOUBLE_COLON])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_309(__match_val):
    return ((Ok((VarPattern(getTokenString(__match_val._field0[0])), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_310(__match_val):
    return ((Ok((first, __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_309(expect(state)(IDENT)('Expected pattern')) if __match_val is Nothing else None))
def __helper_311(__match_val):
    return ((Ok((TuplePattern(elements), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_310(expect(s10)(RPAREN)("Expected ')'")) if __match_val is Nothing else None))
def __helper_312(__match_val):
    return (__helper_311(expect(__match_val._field0[1])(RPAREN)("Expected ')'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_313(__match_val):
    return (__helper_312(parsePatternTupleElements(s11)([first])) if isinstance(__match_val, Just) else None)
def __helper_314(__let_val_69):
    return (lambda mComma, s11: __helper_313(mComma))(__let_val_69[0], __let_val_69[1]) if isinstance(__let_val_69, tuple) and len(__let_val_69) == 2 else None
def __helper_315(__match_val):
    return (__helper_314(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_316(__match_val):
    return (Ok((TuplePattern([]), advance(s9))) if check(s9)([RPAREN]) else __helper_315(parsePattern(s9)) if isinstance(__match_val, Just) else None)
def __helper_317(__let_val_70):
    return (lambda mLParen, s9: __helper_316(mLParen))(__let_val_70[0], __let_val_70[1]) if isinstance(__let_val_70, tuple) and len(__let_val_70) == 2 else None
def __helper_318(__match_val):
    return ((Ok((ListPattern(elements), __match_val._field0[1])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None)) or ((__helper_317(matchToken(state)([LPAREN])) if __match_val is Nothing else None))
def __helper_319(__match_val):
    return (__helper_318(expect(__match_val._field0[1])(RBRACKET)("Expected ']'")) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_320(__match_val):
    return (Ok((ListPattern([]), advance(s8))) if check(s8)([RBRACKET]) else __helper_319(parsePatternListElements(s8)([])) if isinstance(__match_val, Just) else None)
def __helper_321(__let_val_71):
    return (lambda mLBracket, s8: __helper_320(mLBracket))(__let_val_71[0], __let_val_71[1]) if isinstance(__let_val_71, tuple) and len(__let_val_71) == 2 else None
def __helper_322(__match_val):
    return ((Ok((WildcardPattern, s7)) if isinstance(__match_val, Just) else None)) or ((__helper_321(matchToken(state)([LBRACKET])) if __match_val is Nothing else None))
def __helper_323(__let_val_72):
    return (lambda mWildcard, s7: __helper_322(mWildcard))(__let_val_72[0], __let_val_72[1]) if isinstance(__let_val_72, tuple) and len(__let_val_72) == 2 else None
def __helper_324(__match_val):
    return ((Ok((BoolPattern(False), s6)) if isinstance(__match_val, Just) else None)) or ((__helper_323(matchToken(state)([UNDERSCORE])) if __match_val is Nothing else None))
def __helper_325(__let_val_73):
    return (lambda mFalse, s6: __helper_324(mFalse))(__let_val_73[0], __let_val_73[1]) if isinstance(__let_val_73, tuple) and len(__let_val_73) == 2 else None
def __helper_326(__match_val):
    return ((Ok((BoolPattern(True), s5)) if isinstance(__match_val, Just) else None)) or ((__helper_325(matchToken(state)([FALSE])) if __match_val is Nothing else None))
def __helper_327(__let_val_74):
    return (lambda mTrue, s5: __helper_326(mTrue))(__let_val_74[0], __let_val_74[1]) if isinstance(__let_val_74, tuple) and len(__let_val_74) == 2 else None
def __helper_328(__match_val):
    return ((Ok((CharPattern(getTokenChar(__match_val._field0)), s4)) if isinstance(__match_val, Just) else None)) or ((__helper_327(matchToken(state)([TRUE])) if __match_val is Nothing else None))
def __helper_329(__let_val_75):
    return (lambda mChar, s4: __helper_328(mChar))(__let_val_75[0], __let_val_75[1]) if isinstance(__let_val_75, tuple) and len(__let_val_75) == 2 else None
def __helper_330(__match_val):
    return ((Ok((StringPattern(getTokenString(__match_val._field0)), s3)) if isinstance(__match_val, Just) else None)) or ((__helper_329(matchToken(state)([CHAR])) if __match_val is Nothing else None))
def __helper_331(__let_val_76):
    return (lambda mString, s3: __helper_330(mString))(__let_val_76[0], __let_val_76[1]) if isinstance(__let_val_76, tuple) and len(__let_val_76) == 2 else None
def __helper_332(__match_val):
    return ((Ok((FloatPattern(getTokenFloat(__match_val._field0)), s2)) if isinstance(__match_val, Just) else None)) or ((__helper_331(matchToken(state)([STRING])) if __match_val is Nothing else None))
def __helper_333(__let_val_77):
    return (lambda mFloat, s2: __helper_332(mFloat))(__let_val_77[0], __let_val_77[1]) if isinstance(__let_val_77, tuple) and len(__let_val_77) == 2 else None
def __helper_334(__match_val):
    return ((Ok((IntPattern(getTokenInt(__match_val._field0)), s1)) if isinstance(__match_val, Just) else None)) or ((__helper_333(matchToken(state)([FLOAT])) if __match_val is Nothing else None))
def __helper_335(__let_val_78):
    return (lambda mInt, s1: __helper_334(mInt))(__let_val_78[0], __let_val_78[1]) if isinstance(__let_val_78, tuple) and len(__let_val_78) == 2 else None
def __helper_336(__match_val):
    return ((parsePatternListElements(s2)(elements + [elem]) if isinstance(__match_val, Just) else None)) or ((Ok((elements + [elem], s1)) if __match_val is Nothing else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))
def __helper_337(__let_val_79):
    return (lambda mComma, s2: __helper_336(mComma))(__let_val_79[0], __let_val_79[1]) if isinstance(__let_val_79, tuple) and len(__let_val_79) == 2 else None
def __helper_338(__match_val):
    return (__helper_337(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)
def __helper_339(__let_val_80):
    return (lambda mComma, s2: parsePatternTupleElements(s2)(elements + [elem]))(__let_val_80[0], __let_val_80[1]) if isinstance(__let_val_80, tuple) and len(__let_val_80) == 2 else None
def __helper_340(__match_val):
    return ((__helper_339(matchToken(__match_val._field0[1])([COMMA])) if isinstance(__match_val, Ok) and isinstance(__match_val._field0, tuple) and len(__match_val._field0) == 2 else None)) or ((Err(__match_val._field0) if isinstance(__match_val, Err) else None))